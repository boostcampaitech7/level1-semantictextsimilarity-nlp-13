# Level 1 Project :: STS(Semantic Text Similarity)

### ğŸ“ Abstract
- ì´ í”„ë¡œì íŠ¸ëŠ” ë„¤ì´ë²„ ë¶€ìŠ¤íŠ¸ ìº í”„ AI-Tech 7ê¸° NLP Level 1 ê¸°ì´ˆ í”„ë¡œì íŠ¸ ê²½ì§„ëŒ€íšŒë¡œ, Daconê³¼ Kaggleê³¼ ìœ ì‚¬í•œ ëŒ€íšŒí˜• ë°©ì‹ìœ¼ë¡œ ì§„í–‰ë˜ì—ˆë‹¤.
- ë‘ ë¬¸ì¥ì´ ì˜ë¯¸ì ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ë¥¼ ìˆ˜ì¹˜í™”í•˜ëŠ” N21 ìì—°ì–´ì²˜ë¦¬ Taskì¸ ì˜ë¯¸ ìœ ì‚¬ë„ íŒë³„(Semantic Text Similarity, STS)ë¥¼ ì£¼ì œë¡œ, ëª¨ë“  íŒ€ì›ì´ ë°ì´í„° ì „ì²˜ë¦¬ë¶€í„° ì•™ìƒë¸”ê¹Œì§€ AI ëª¨ë¸ë§ì˜ ì „ ê³¼ì •ì„ í•¨ê»˜ í˜‘ì—…í–ˆë‹¤.

<br>

## Project Leader Board 
- Public Leader Board
<img width="1089" alt="public_leader_board" src="https://github.com/user-attachments/assets/4d4592bc-1e3e-4455-8de9-cf61e5fc6d50">

- Private Leader Board 
<img width="1089" alt="private_leader_board" src="https://github.com/user-attachments/assets/f1a5b53d-f30b-4d87-8a14-3cc1a602f8a0">

- [ğŸ“ˆ NLP 13ì¡° Project Wrap-Up report ì‚´í´ë³´ê¸°](https://github.com/user-attachments/files/17182231/NLP_13.Wrap-Up.pdf
)

<br>

## ğŸ§‘ğŸ»â€ğŸ’» Team Introduction & Members 

> Team name : ìŠ¤ë¹ˆë¼í‚¨ìŠ¤ë°° [ NLP 13ì¡° ]

### ğŸ‘¨ğŸ¼â€ğŸ’» Members
ê¶Œì§€ìˆ˜|ê¹€ì„±ì€|ê¹€íƒœì›|ì´í•œì„œ|ì •ì£¼í˜„|
:-:|:-:|:-:|:-:|:-:
<img src='https://github.com/user-attachments/assets/ab4b7189-ec53-41be-8569-f40619b596ce' height=125 width=100></img>|<img src='https://github.com/user-attachments/assets/49dc0e59-93ee-4e08-9126-4a3deca9d530' height=125 width=100></img>|<img src='https://github.com/user-attachments/assets/a15b0f0b-cd89-412b-9b3d-f59eb9787613' height=125 width=100></img>|<img src='https://github.com/user-attachments/assets/11b2ed88-bf94-4741-9df5-5eb2b9641a9b' height=125 width=100></img>
[Github](https://github.com/Kwon-Jisu)|[Github](https://github.com/ssungni)|[Github](https://github.com/chris40461)|[Github](https://github.com/beaver-zip)|[Github](https://github.com/peter520416)
<a href="mailto:wltn80609@ajou.ac.kr" target="_blank"><img src="https://img.shields.io/badge/Gmail-EA4335?style&logo=Gmail&logoColor=white"/></a>|<a href="mailto:sunny020111@ajou.ac.kr" target="_blank"><img src="https://img.shields.io/badge/Gmail-EA4335?style&logo=Gmail&logoColor=white"/></a>|<a href="mailto:chris40461@gmail.com" target="_blank"><img src="https://img.shields.io/badge/Gmail-EA4335?style&logo=Gmail&logoColor=white"/></a>|<a href="mailto:beaver.zip@gmail.com" target="_blank"><img src="https://img.shields.io/badge/Gmail-EA4335?style&logo=Gmail&logoColor=white"/></a>|<a href="mailto:peter520416@gmail.com" target="_blank"><img src="https://img.shields.io/badge/Gmail-EA4335?style&logo=Gmail&logoColor=white"/></a>|

### ğŸ§‘ğŸ»â€ğŸ”§ Members' Role
> ê¹€íƒœì› ìº í¼ëŠ” 13ì¡°ì˜ íŒ€ì¥ì„ ë§¡ì•„ íŒ€ì„ ì´ëŒë©°, ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ë¶„ì„í•˜ê³ , ë°ì´í„° ì¦ê°•ì— í° ê¸°ì—¬ë¥¼ í–ˆë‹¤. ì •ì£¼í˜„ ìº í¼ì™€ ì´í•œì„œ ìº í¼ëŠ” ì£¼ë¡œ ì •ê·œ í‘œí˜„ì‹ì„ í™œìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì „ì²˜ë¦¬í•˜ê³ , ì¡°ì‚¬(ì€, ëŠ”, ì´, ê°€, ì„, ë¥¼, ê³¼, ì™€)ë¥¼ ëœë¤í™”í•˜ëŠ” ê¸°ë²•ìœ¼ë¡œ ë°ì´í„° í’ˆì§ˆì„ í–¥ìƒì‹œì¼°ë‹¤. ê¹€ì„±ì€ ìº í¼ì™€ ê¶Œì§€ìˆ˜ ìº í¼ëŠ” Hugging Faceì™€ GitHubì— ìˆëŠ” ë‹¤ì–‘í•œ ëª¨ë¸ì„ íƒìƒ‰í•˜ë©°, ìµœì í™” ì‘ì—…ì„ í†µí•´ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í•˜ëŠ”ë° ì£¼ë ¥í–ˆë‹¤.

| ì´ë¦„ | ì—­í•  |
| :---: | --- |
| **`ê¶Œì§€ìˆ˜`** | **EDA** (ë¼ë²¨ ë¶„í¬ ë°ì´í„°ë¶„ì„), **ëª¨ë¸ íƒìƒ‰** (KLUE: ë…¼ë¬¸ ë°”íƒ•ìœ¼ë¡œ RoBERTaì™€ ELECTRA ê³„ì—´ ëª¨ë¸ ì¤‘ì‹¬ìœ¼ë¡œ íƒìƒ‰), **ëª¨ë¸ ì‹¤í—˜** (team-lucid/deberta-v3-base-korean), **Ensemble ì‹¤í—˜** (output í‰ê·  ë° ê°€ì¤‘ì¹˜ í™œìš©) |
| **`ê¹€ì„±ì€`** | **EDA** (ë¼ë²¨ ë¶„í¬ ë°ì´í„°ë¶„ì„), **ëª¨ë¸ íƒìƒ‰** (Encoder, Decoder, Encoder - Decoder ëª¨ë¸ë¡œ ì„¸ë¶„í™”í•˜ì—¬ íƒìƒ‰), **ëª¨ë¸ ì‹¤í—˜** (snunlp-KR-ELECTRA), **Ensemble ì‹¤í—˜** (output í‰ê·  ë° ê°€ì¤‘ì¹˜ í™œìš©) |
| **`ê¹€íƒœì›`** | **ëª¨ë¸ ì‹¤í—˜** (KR-ELECTRA-discriminator, electra-kor-base, deberta-v3, klue-roberta ), **ë°ì´í„° ì¦ê°•** (label rescaling(0ì  ì¸ë±ìŠ¤ì˜ ì œê±° ë° 5ì  ì¸ë±ìŠ¤ ì¶”ê°€), ë‹¨ìˆœ ë³µì œ ë°ì´í„° ì¦ê°•(1ì ~3ì  ì¸ë±ìŠ¤), train ë°ì´í„°ì˜ ì „ì²´ì ì¸ ë§ì¶¤ë²• êµì •/ë¶ˆìš©ì–´ ì œê±°/ë„ì–´ì“°ê¸° êµì •), **ëª¨ë¸ Ensemble** (weighted sum for 3model/4models) |
| **`ì´í•œì„œ`** |**ë°ì´í„° ì¦ê°•**(ì¡°ì‚¬ ëŒ€ì²´, Label ë¶„í¬ ê· í˜•í™”), **ëª¨ë¸ ì‹¤í—˜**(team-lucid/deberta-v3-base-korean, monologg/koelectra-base-v3-discriminator, snunlp/KR-ELECTRA), Hyperparameter Tuning(Optuna Template ì œì‘ ë° ì‹¤í—˜)|
| **`ì •ì£¼í˜„`** &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | **ë°ì´í„° EDA** (Label ë¶„í¬, ë¬¸ì¥ ë‚´ì˜ ë‹¨ì–´ ë¹ˆë„), **ë°ì´í„° ì¦ê°•** (Swap sentence1 and sentence2, ìœ ì˜ì–´ êµì²´(â€˜ë„ˆë¬´â€™, â€˜ì§„ì§œâ€™, â€˜ì •ë§â€™)), **ëª¨ë¸ ì„ ì • ë° Ensemble** (T5-base-korean-summarization), Ensemble(Blending Ensemble for 3 or 4 model(meta model = Ridge)) |

<br>

## ğŸ–¥ï¸ Project Introduction 


|**í”„ë¡œì íŠ¸ ì£¼ì œ**| **`Semantic Text Similarity (STS)` :** ë‘ í…ìŠ¤íŠ¸ê°€ ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ íŒë‹¨í•˜ëŠ” NLP Task|
| :---: | --- |
|**í”„ë¡œì íŠ¸ êµ¬í˜„ë‚´ìš©**| 1. Hugging Face ì˜ Pretrained ëª¨ë¸ê³¼ STS ë°ì´í„°ì…‹ì„ í™œìš©í•´ ë‘ ë¬¸ì¥ì˜ 0 ê³¼ 5 ì‚¬ì´ì˜ ìœ ì‚¬ë„ë¥¼ ì¸¡ì •í•˜ëŠ” AI ëª¨ë¸ì„ êµ¬ì¶• <br>2. ë¦¬ë”ë³´ë“œ í‰ê°€ì§€í‘œì¸ í”¼ì–´ìŠ¨ ìƒê´€ ê³„ìˆ˜(Pearson Correlation Coefficient ,PCC)ì—ì„œ ë†’ì€ ì ìˆ˜(1ì— ê°€ê¹Œìš´ ì ìˆ˜)ì— ë„ë‹¬í•  ìˆ˜ ìˆë„ë¡ ë°ì´í„° ì „ì²˜ë¦¬, ì¦ê°•, í•˜ì´í¼ íŒŒë¼ë¯¸í„° íŠœë‹ì„ ì§„í–‰|
|**ê°œë°œ í™˜ê²½**|**â€¢ `GPU` :** Tesla V100 ì„œë²„ 4ê°œ (RAM32G)<br> **â€¢ `ê°œë°œ Tool` :** Jupyter notebook, VS Code [ì„œë²„ SSHì—°ê²°]
|**í˜‘ì—… í™˜ê²½**|**â€¢ `Github Repository` :** Baseline ì½”ë“œ ê³µìœ  ë° ë²„ì „ ê´€ë¦¬, ê°œì¸ branchë¥¼ ì‚¬ìš©í•´ ì‘ì—…ìƒí™© ê³µìœ  <br>**â€¢ `Notion` :** STS í”„ë¡œì íŠ¸ í˜ì´ì§€ë¥¼ í†µí•œ ì—­í• ë¶„ë‹´, ì‹¤í—˜ ê°€ì„¤ ì„¤ì • ë° ê²°ê³¼ ê³µìœ  <br>**â€¢ `SLACK, Zoom` :** ì‹¤ì‹œê°„ ëŒ€ë©´/ë¹„ëŒ€ë©´ íšŒì˜|

<br>

## ğŸ“ Project Structure

### ğŸ—‚ï¸ ë””ë ‰í† ë¦¬ êµ¬ì¡° ì„¤ëª…
- í•™ìŠµ ë°ì´í„° ê²½ë¡œ:Â `./data`
- í•™ìŠµ ë©”ì¸ ì½”ë“œ: `./train.py`
- í•™ìŠµ ë°ì´í„°ì…‹ ê²½ë¡œ: `./data/aug_train.csv`
- í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ ê²½ë¡œ: `./data/test.csv`

### ğŸ“„ ì½”ë“œ êµ¬ì¡° ì„¤ëª…

> í•™ìŠµ ì§„í–‰í•˜ê¸° ì „ ë°ì´í„° ì¦ê°•ì„ ë¨¼ì € ì‹¤í–‰í•˜ì—¬ í•™ìŠµ ì‹œê°„ ë‹¨ì¶•

- **ë°ì´í„° ì¦ê°•Â Get Augmentation Data** : `augmentation.py`
- **Train** : `train.py`
- **Predict** : `test.py`
- **Ensemble** : `weighted_ensemble.py`, `blending_ensemble.py`
- **ìµœì¢… ì œì¶œ íŒŒì¼** : `/output/Ensemble/blending_ensemble.csv`

```
ğŸ“¦level1_semantictextsimilarity-nlp-11
 â”£ .gitignore
 â”£ config_yaml
 â”ƒ â”£ kykim.yaml
 â”ƒ â”£ snunlp.yaml
 â”ƒ â”£ test.yaml
 â”ƒ â”— xlm_roberta_large.yaml
 â”£ data
 â”ƒ â”£ train.csv
 â”ƒ â”£ aug_train.csv
 â”ƒ â”£ dev.csv
 â”ƒ â”— test.csv
 â”£ wordnet
 â”ƒ â”— wordnet.pickle
 â”£ save_folde
 â”ƒ â”£ kykim
 â”ƒ â”ƒ â”— checkpoint-7960
 â”ƒ â”£ snunlp
 â”ƒ â”ƒ â”— checkpoint-31824
 â”ƒ â”— xlm_roberta_large
 â”ƒ   â”— checkpoint-7960
 â”£ esnb
 â”ƒ â”— esnb.csv
 â”£ output
 â”ƒ â”£ xlm_roberta_large.csv
 â”ƒ â”£ kykim.csv
 â”ƒ â”— snunlp.csv
 â”£ .gitignore
 â”£ Readme.md
 â”£ augmentation.py
 â”£ dataloader.py
 â”£ esnb.py
 â”£ infer.py
 â”£ train.py
 â”— utils.py
 ```
<br>

## ğŸ“ Project Ground Rule
>íŒ€ í˜‘ì—…ì„ ìœ„í•´ í”„ë¡œì íŠ¸ ê´€ë ¨ Ground Ruleì„ ì„¤ì •í•˜ì—¬ í”„ë¡œì íŠ¸ê°€ ì›í™œí•˜ê²Œ ëŒì•„ê°ˆ ìˆ˜ ìˆë„ë¡ ê·œì¹™ì„ ì •í–ˆìœ¼ë©°, ë‚ ì§œ ë‹¨ìœ„ë¡œ ê°„ëµí•œ ëª©í‘œë¥¼ ì„¤ì •í•˜ì—¬ í˜‘ì—…ì„ ì›í™œí•˜ê²Œ ì§„í–‰í•  ìˆ˜ ìˆë„ë¡ ê³„íší•˜ì—¬ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

**- a. `Server ê´€ë ¨`** : ê¶Œì§€ìˆ˜, ê¹€ì„±ì€, ì´í•œì„œ, ì •ì£¼í˜„ ìº í¼ëŠ” ê°ì ì„œë²„ë¥¼ ìƒì„±í•´ ëª¨ë¸ ì‹¤í—˜ì„ ì§„í–‰í•˜ê³ , ê¹€íƒœì› ìº í¼ëŠ” ì„œë²„ê°€ ìœ íœ´ ìƒíƒœì¸ ì„œë²„ì—ì„œ ì‹¤í—˜ì„ ì§„í–‰í–ˆë‹¤.

**- b. `Git ê´€ë ¨`** : ê°ì branch ìƒì„±í•´ ì‘ì—…í•˜ê³ , ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•  íŒŒì¼ì€ mainì— push í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ í˜‘ì—…í–ˆë‹¤.

**- c. `Submission ê´€ë ¨`** : ëŒ€íšŒ ë§ˆê° 2ì¼ ì „ê¹Œì§€ëŠ” ììœ ë¡­ê²Œ ì œì¶œí–ˆê³ , 2ì¼ ì „ë¶€í„°ëŠ” ì¸ë‹¹ 2íšŒì”© ë¶„ë°°í–ˆë‹¤.

**- d. `Notion ê´€ë ¨`** : ì›í™œí•œ ì•„ì´ë””ì–´ ë¸Œë ˆì¸ìŠ¤í† ë°ê³¼ ë¶„ì—…ì„ ìœ„í•´ íšŒì˜ë¥¼ í•  ê²½ìš° ë…¸ì…˜ì— ê¸°ë¡í•˜ë©°, ì—°êµ¬ ë° ì‹¤í—˜ê²°ê³¼ì˜ ê¸°ë¡ì„ ê³µìœ í–ˆë‹¤.

<br>

## ğŸ—“ Project Procedure: ì´ 9ì¼ ì§„í–‰
- **`(1~3 ì¼ì°¨)`**: EDA ë¶„ì„
- **`(3~5 ì¼ì°¨)`**: ë°ì´í„° ì „ì²˜ë¦¬
- **`(6~11 ì¼ì°¨)`** : ë°ì´í„° ì¦ê°•
- **`(7~12 ì¼ì°¨)`** : ëª¨ë¸ë§ ë° íŠœë‹
- **`(11~13 ì¼ì°¨)`** : ì•™ìƒë¸”

*ì•„ë˜ëŠ” ì €í¬ í”„ë¡œì íŠ¸ ì§„í–‰ê³¼ì •ì„ ë‹´ì€ Ganttì°¨íŠ¸ ì…ë‹ˆë‹¤. 
<img width="486" alt="Gantt" src="https://github.com/user-attachments/assets/9f8bdf26-f22c-487d-8443-2faf60ccbe08">

<br>

### **ğŸ“ŠDataSet**
* ìš°ë¦¬ëŠ” ë¨¼ì € ë°ì´í„°ì˜ ì–‘ì´ ì ê³  ë¶ˆê· í˜•í•˜ë‹¤ëŠ” ì ì„ í™•ì¸í–ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë°ì´í„°ì˜ ì–‘ì„ ì ˆëŒ€ì ìœ¼ë¡œ ëŠ˜ë¦° í›„, ì¦ê°•ëœ ë°ì´í„°ì˜ ë¼ë²¨ ë¶„í¬ë¥¼ ê³ ë ¤í•˜ì—¬ ì¶”ê°€ì ì¸ ë°ì´í„° ì¦ê°•ì„ ì§„í–‰í–ˆë‹¤.

|**Techniques**|**Description**|
|:--:|:--:|
|**Swap sentence**|ì „ì²´ ë°ì´í„°ë¥¼ sentence1ê³¼ sentence2ì˜ ìˆœì„œë¥¼ ë°”ê¾¸ì–´ ë°ì´í„°ì˜ ì–‘ì„ ì•½ 2ë°°ë¡œ ì¦ê°•í–ˆë‹¤.|
|**ìœ ì˜ì–´ êµì²´ë¥¼<br> í†µí•œ ì¦ê°•**|raw ë°ì´í„°ì…‹ì—ì„œ sentence 1ê³¼ sentence 2ì— 'ë„ˆë¬´', 'ì •ë§', 'ì§„ì§œ'ë¼ëŠ” ë‹¨ì–´ê°€ ë§ì´ ë“¤ì–´ê°€ ìˆë‹¤ëŠ” ê²ƒì„ íŒë‹¨í•˜ì—¬ í•´ë‹¹ ë‹¨ì–´ë“¤ì´ í¬í•¨ëœ ë¬¸ì¥ì—ì„œ ê·¸ ì¤‘ í•œ ë‹¨ì–´ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë‘ ë‹¨ì–´ ì¤‘ í•˜ë‚˜ë¡œ ë¬´ì‘ìœ„ ëŒ€ì²´í•˜ì—¬ ë°ì´í„°ë¥¼ ì¦ê°•í–ˆë‹¤.|

<br>



## ğŸ¤–**Ensemble Model**

* ìµœì¢…ì ìœ¼ë¡œ 5ê°œì˜ ëª¨ë¸ì„ blending ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

|**Model**|**Learing Rate**|**Batch Size**|**loss**|**epoch**|**dev person (val_pearson)**|**Scheduler**|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|**klue/roberta-base**|1e-5|16|L2(MSE)|10|0.9216|stepLR|
|**kykim/electra-kor-base**|1e-5|16|L2(MSE)|10|0.9259|stepLR|
|**team-lucid/deberta-v3-base-korean**|1e-4|16|L2(MSE)|10|0.9327|stepLR|
|**snunlp/KR-ELECTRA-discriminator**|1e-5|16|L2(MSE)|10|0.9333|stepLR|
|**eenzeenee/t5-base-korean-summarization**|1e-5|16|L2(MSE)|10|stepLR|

<br>

## ğŸ’» Getting Started

### âš ï¸  How To install Requirements
```bash
# í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
pip install -r requirements.txt
```

### âŒ¨ï¸ How To Train & Test
```bash
#ë°ì´í„° ì¦ê°•
python3 augmentation.py
# train.py ì½”ë“œ ì‹¤í–‰ : ëª¨ë¸ í•™ìŠµì„ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰
# ì´í›„ test.py ì½”ë“œë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ì—¬ test
# config.yaml ë‚´ ëª¨ë¸ ì´ë¦„, lr ì„ ë¦¬ìŠ¤íŠ¸ ìˆœì„œëŒ€ë¡œ ë³€ê²½í•˜ë©° train ìœ¼ë¡œ í•™ìŠµ

#plm_name[0], lr[0] -> klue/roberta-base
python3 train.py
python3 test.py

#plm_name[1], lr[1] -> kykim/electra-kor-base
python3 train.py
python3 test.py

#plm_name[2], lr[2] -> team-lucid/deberta-v3-base-korean 
python3 train.py
python3 test.py

#plm_name[3], lr[3] -> snunlp/KR-ELECTRA-discriminator
python3 train.py
python3 test.py

#plm_name[4], lr[4] -> eenzeenee/t5-base-korean- summarization
python3 train.py
python3 test.py

```

### âŒ¨ï¸ How To Ensemble
```bash
# ìˆœì°¨ì ìœ¼ë¡œ weighted ensemble ì§„í–‰ í›„, ì¶œë ¥ ê²°ê³¼ë¥¼ ì‚¬ìš©í•´ì„œ blended ensemble ì§„í–‰
python3 weighted_ensemble.py # klue/roberta-base, eenzeenee/t5-base-korean-summarization, kykim/electra-kor-base
python3 blending_ensemble.py # kykim/electra-kor-base , team-lucid/deberta-v3-base-korean , snunlp/KR-ELECTRA-discriminator, weighted_ensemble
```

